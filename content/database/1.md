---
title: "친절한 SQL 튜닝 1.1 요약 정리"
date: 2021-02-23T00:00:00+00:00
description: "1.1 SQL 파싱과 최적화"
tags: ["database"]
---

### **1.1 SQL 파싱과 최적화**  

**1.1.1 구조적, 집합적, 선언적 질의 언어**  

**1.1.2 SQL 최적화**  
DBMS 내부에서 프로시저를 작성하고 컴파일 하여 실행 가능한 상태로 만드는 전 과정
  
(1) SQL 파싱  
사용자로부터 SQL을 전달받으면 가장 먼저 SQL 파서가 파싱을 진행  
- 파싱 트리 생성 : SQL 문을 이루는 개별 구성요소를 분석해 파싱 트리 생성  
- Syntax 체크 : 문법 오류 확인. 사용할 수 없는 키워드, 순서 오류, 누락 키워드 체크  
- semantic 체크 : 의미상 오류 없는지 확인. 존재하지 않는 테이블, 컬럼 사용, 권한 확인  

(2) SQL 최적화  
SQL 옵티마이저가 미리 수집한 시스템 및 오브젝트 통계정보를 바탕으로 실행경로 생성. 비교 후 가장 효율적인 하나 선택  
데이터베이스 성능을 결정하는 가장 핵심적인 엔진  

(3) 로우 소스 생성  
옵티마이저가 선택한 실행경로를 실제 실행 가능한 코드, 프로시저 형태로 포맷팅 하는 단계 (로우 소스 생성기)  

**1.1.3 SQL 옵티마이저**
1. 쿼리 수행하는데 후보군 실행계획 찾아냄
2. 데이터 딕셔너리에 미리 수집해 둔 오브젝트 통계 및 시스템 통계 정보를 이용해 각 실행계획의 예상비용 산정
3. 최저 비용의 실행계획 선택

**1.1.4 실행계획과 비용**  
SQL 옵티마이저 = 자동차 내비게이션(모의 주행)  
SQL 실행경로 미리보기(실행 계획)  
옵티마이저가 특정 실행계획을 선택하는 근거? 비용(cost)값 확인  
힌트를 통해 다른 실행계획 확인 가능  
```
SELECT /*+ full(t) */ * FROM t
```
비용? 쿼리를 수행하는 동안 발생할 것으로 예상하는 I/O 횟수 또는 예상 소요시간  

**1.1.5 옵티마이저 힌트**
옵티마이저 힌트를 이용해 액세스 경로를 바꿀 수 있음  
```
SELECT /*+ INDEX(A 고객_PK) */
    고객명, 연락처, 주소, 가입일시
  FROM 고객 A
 WHERE 고객 ID = '000000008'
```
* 힌트 안에 인자를 나열할 땐 콤마 사용O, 힌트와 힌트 사이에 사용X  
* 스키마명 명시 X  
* ALIAS 사용했을 경우 힌트에도 반드시 ALIAS 사용  

### **1.2 SQL 공유 및 재사용**
소프트 파싱과 하드 파싱의 차이점

**1.2.1 소프트 파싱 vs 하드 파싱
라이브러리 캐시? SQL 파싱, 최적화, 로우 소스 생성을 거쳐 생성한 내부 프로시저를 반복 재사용할 수 있또록 캐싱하는 메모리 공간  
라이브러리 캐시는 SGA 구성요소
SGA? 서버 프로세스와 백그라운드 프로세스가 공통으로 액세스하는 데이터와 제어 구조를 캐싱하는 메모리 공간  
